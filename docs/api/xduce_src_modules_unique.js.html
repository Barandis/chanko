<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>xduce/src/modules/unique.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-csp.html">csp</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-csp.html#.chan">chan</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.channel">channel</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.close">close</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.config">config</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.dropping">dropping</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.fixed">fixed</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.go">go</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.isBuffered">isBuffered</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.isClosed">isClosed</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.isTimed">isTimed</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.join">join</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.recv">recv</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.recvAsync">recvAsync</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.recvOrThrow">recvOrThrow</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.select">select</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.selectAsync">selectAsync</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.send">send</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.sendAsync">sendAsync</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.sleep">sleep</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.sliding">sliding</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.timedChan">timedChan</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.transChan">transChan</a></li><li data-type='method' style='display: none;'><a href="module-csp.html#.value">value</a></li></ul></li><li><a href="module-csp-ops.html">csp-ops</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-csp-ops.html#.debounce">debounce</a></li><li data-type='method' style='display: none;'><a href="module-csp-ops.html#.map">map</a></li><li data-type='method' style='display: none;'><a href="module-csp-ops.html#.merge">merge</a></li><li data-type='method' style='display: none;'><a href="module-csp-ops.html#.partition">partition</a></li><li data-type='method' style='display: none;'><a href="module-csp-ops.html#.pipe">pipe</a></li><li data-type='method' style='display: none;'><a href="module-csp-ops.html#.reduce">reduce</a></li><li data-type='method' style='display: none;'><a href="module-csp-ops.html#.split">split</a></li><li data-type='method' style='display: none;'><a href="module-csp-ops.html#.tap">tap</a></li><li data-type='method' style='display: none;'><a href="module-csp-ops.html#.throttle">throttle</a></li><li data-type='method' style='display: none;'><a href="module-csp-ops.html#.toArray">toArray</a></li><li data-type='method' style='display: none;'><a href="module-csp-ops.html#.toChannel">toChannel</a></li><li data-type='method' style='display: none;'><a href="module-csp-ops.html#.untap">untap</a></li><li data-type='method' style='display: none;'><a href="module-csp-ops.html#.untapAll">untapAll</a></li></ul></li><li><a href="module-xdcore.html">xdcore</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-xdcore.html#.complete">complete</a></li><li data-type='method' style='display: none;'><a href="module-xdcore.html#.ensureCompleted">ensureCompleted</a></li><li data-type='method' style='display: none;'><a href="module-xdcore.html#.ensureUncompleted">ensureUncompleted</a></li><li data-type='method' style='display: none;'><a href="module-xdcore.html#.isArray">isArray</a></li><li data-type='method' style='display: none;'><a href="module-xdcore.html#.isCompleted">isCompleted</a></li><li data-type='method' style='display: none;'><a href="module-xdcore.html#.isFunction">isFunction</a></li><li data-type='method' style='display: none;'><a href="module-xdcore.html#.isGeneratorFunction">isGeneratorFunction</a></li><li data-type='method' style='display: none;'><a href="module-xdcore.html#.isImplemented">isImplemented</a></li><li data-type='method' style='display: none;'><a href="module-xdcore.html#.isIterable">isIterable</a></li><li data-type='method' style='display: none;'><a href="module-xdcore.html#.isNumber">isNumber</a></li><li data-type='method' style='display: none;'><a href="module-xdcore.html#.isObject">isObject</a></li><li data-type='method' style='display: none;'><a href="module-xdcore.html#.isString">isString</a></li><li data-type='method' style='display: none;'><a href="module-xdcore.html#.iterator">iterator</a></li><li data-type='method' style='display: none;'><a href="module-xdcore.html#.reduce">reduce</a></li><li data-type='method' style='display: none;'><a href="module-xdcore.html#.toFunction">toFunction</a></li><li data-type='method' style='display: none;'><a href="module-xdcore.html#.toReducer">toReducer</a></li><li data-type='method' style='display: none;'><a href="module-xdcore.html#.toTransducer">toTransducer</a></li><li data-type='method' style='display: none;'><a href="module-xdcore.html#.uncomplete">uncomplete</a></li></ul></li><li><a href="module-xduce.html">xduce</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-xduce.html#.asArray">asArray</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.asIterator">asIterator</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.asObject">asObject</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.asString">asString</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.chunk">chunk</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.chunkBy">chunkBy</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.complement">complement</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.compose">compose</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.distinct">distinct</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.distinctBy">distinctBy</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.distinctWith">distinctWith</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.drop">drop</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.dropWhile">dropWhile</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.filter">filter</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.flatMap">flatMap</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.flatten">flatten</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.identity">identity</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.into">into</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.key">key</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.kv">kv</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.map">map</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.reject">reject</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.repeat">repeat</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.sequence">sequence</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.take">take</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.takeNth">takeNth</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.takeWhile">takeWhile</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.toFunction">toFunction</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.toReducer">toReducer</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.transduce">transduce</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.unique">unique</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.uniqueBy">uniqueBy</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.uniqueWith">uniqueWith</a></li><li data-type='method' style='display: none;'><a href="module-xduce.html#.value">value</a></li></ul></li></ul><h3>Externals</h3><ul><li><a href="external-Iterable.html">Iterable</a></li><li><a href="external-Iterator.html">Iterator</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">xduce/src/modules/unique.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Copyright (c) 2020 Thomas J. Otterson
 *
 * This software is released under the MIT License.
 * https://opensource.org/licenses/MIT
 */

/**
 * Transducers for rejecting repeated elements in a collection.
 *
 * @module xduce/unique
 * @private
 */

import { protocols as p, toTransducer } from "@chanko/xdcore";
import { parseFunctionArgs, sameValueZero } from "modules/utils";
import { sequence } from "modules/transduction";

/**
 * Removes all duplicates from a collection, using a comparator function to
 * determine what's unique.
 *
 * Comparisons are made by passing each pair of elements to the function, which
 * must take two parameters and return a boolean indicating whether or not the
 * values are equal. As an example, the `{@link module:xduce.unique|unique}`
 * transducer could be regarded as the same as this transducer, with a
 * {@link http://ecma-international.org/ecma-262/6.0/#sec-samevaluezero|SameValueZero}
 * function serving as the comparator.
 *
 * If no collection is provided, a transducer function is returned that can be
 * passed to `{@link module:xduce.sequence|sequence}`, et al.
 *
 * ```
 * // magnitude returns the number of digits in a number
 * function magnitude(x) {
 *   return Math.floor(Math.log(x) / Math.LN10 + 0.000000001);
 * }
 * function comparator(a, b) {
 *   return magnitude(a) === magnitude(b);
 * }
 *
 * // Returns only the first value of each magnitude
 * const result = uniqueWith([1, 10, 100, 42, 56, 893, 1111, 1000], comparator);
 * console.log(result);  // -> [1, 10, 100, 1111]
 * ```
 *
 * @memberof module:xduce
 * @param {module:xduce.Collection} [collection] An optional input collection
 *     that is to be transduced.
 * @param {function} fn A comparator function. This takes two arguments and
 *     returns `true` if they're to be regarded as equal.
 * @returns {(module:xduce.Collection|module:xdcore.TransducerFunction)} If a
 *     collection is supplied, then the function returns a new collection of the
 *     same type with all of the elements of the input collection transformed.
 *     If no collection is supplied, a transducer function, suitable for passing
 *     to `{@link module:xduce.sequence|sequence}`,
 *     `{@link module:xduce.into|into}`, etc. is returned.
 */
function uniqueWith(collection, fn) {
  const [col, func] = parseFunctionArgs(collection, fn);
  return col
    ? sequence(col, uniqueWith(func))
    : next => {
        const uniques = [];
        return toTransducer((acc, value) => {
          if (uniques.some(u => func(value, u))) {
            return acc;
          }
          uniques.push(value);
          return next[p.step](acc, value);
        }, next);
      };
}

/**
 * Applies a function each element of a collection and removes elements that
 * create duplicate return values.
 *
 * Once the function is applied to the collection elements, a comparison is made
 * using
 * {@link http://ecma-international.org/ecma-262/6.0/#sec-samevaluezero|SameValueZero}.
 * If a comparison indicates that the return value from the function for one
 * element is the same as the return value for another element, only the first
 * element is retained in the output collection.
 *
 * Also note that even though the function can cause a completely different
 * value to be compared, the *element* (not the return value of the function) is
 * what is added to the output collection.
 *
 * A very common use for `uniqueBy` is to refer to a particular property in an
 * array of objects. Another is to do a case-insensitive comparison by passing a
 * function that turns every letter in a string to the same case. However, it
 * can be used in any number of different ways, depending on the function used.
 *
 * If no collection is provided, a transducer function is returned that can be
 * passed to `{@link module:xduce.sequence|sequence}`, et al.
 *
 * ```
 * var array = [{x: 1}, {x: 1}, {x: 2}, {x: 3}, {x: 3}, {x: 3},
 *              {x: 4}, {x: 5}, {x: 3}, {x: 1}, {x: 5}];
 *
 * var result = uniqueBy(array, obj => obj.x);
 * console.log(result);  // -> [{x: 1}, {x: 2}, {x: 3}, {x: 4}, {x: 5}]
 *
 * // Comparison is case-insensitive, the duplicate letter retained is the first
 * // one that appears. This is why 'N' is present in the output, not 'n', for
 * // example.
 * result = uniqueBy('aNtidiseSTablIshmENtaRianiSM', x => x.toLowerCase());
 * console.log(result);  // -> 'aNtidseblhmR'
 * ```
 *
 * @memberof module:xduce
 * @param {module:xduce.Collection} [collection] An optional input collection
 *     that is to be transduced.
 * @param {function} fn A function of one parameter applied to each element in
 *     the input collection before testing the results for uniqueness.
 * @returns {(module:xduce.Collection|module:xdcore.TransducerFunction)} If a
 *     collection is supplied, then the function returns a new collection of the
 *     same type with all of the elements of the input collection transformed.
 *     If no collection is supplied, a transducer function, suitable for passing
 *     to `{@link module:xduce.sequence|sequence}`,
 *     `{@link module:xduce.into|into}`, etc. is returned.
 */
function uniqueBy(collection, fn) {
  const [col, func] = parseFunctionArgs(collection, fn);
  return uniqueWith(col, (a, b) => sameValueZero(func(a), func(b)));
}

/**
 * Removes all duplicates from a collection.
 *
 * Once an element is added to the output collection, an equal element will
 * never be added to the output collection again. 'Equal' according to this
 * transformer is a
 * {@link http://ecma-international.org/ecma-262/6.0/#sec-samevaluezero|SameValueZero}
 * comparison.
 *
 * If no collection is provided, a transducer function is returned that can be
 * passed to `{@link module:xduce.sequence|sequence}`, et al.
 *
 * ```
 * var result = unique([1, 1, 2, 3, 3, 3, 4, 5, 3, 1, 5]);
 * console.log(result);  // -> [1, 2, 3, 4, 5];
 * ```
 *
 * @memberof module:xduce
 * @param {module:xduce.Collection} [collection] An optional input collection
 *     that is to be transduced.
 * @returns {(module:xduce.Collection|module:xdcore.TransducerFunction)} If a
 *     collection is supplied, then the function returns a new collection of the
 *     same type with all of the elements of the input collection transformed.
 *     If no collection is supplied, a transducer function, suitable for passing
 *     to `{@link module:xduce.sequence|sequence}`,
 *     `{@link module:xduce.into|into}`, etc. is returned.
 */
function unique(collection) {
  return uniqueWith(collection, sameValueZero);
}

export { unique, uniqueBy, uniqueWith };
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a> on Tue Apr 07 2020 14:24:58 GMT-0400 (Eastern Daylight Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
